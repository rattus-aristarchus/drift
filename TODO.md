# ФУНКЦИОНАЛЬНОСТЬ

# юай
_мордочка_

- сделать выбор иконок из массива спрайтов а не отдельными файлами

# ио
_чтение/запись с диска_

- модели раньше использовались как абстрактные "неизменяемые" значения; сделать для таких 
значений тупо словарь словарей констант
- добавить возможность прописывать "pops" и "groups" в csv-файле карты.
(хз насколько важно если карты будут генерируемыми)
- нужно сделать так, чтобы загружены в factory были только модели из определенной папки; 
или создавать отдельную factory для каждой папки. иначе будет проблема с одинаковыми именами
entities. плюс надо где-то добавить указание, что имена entities должны быть уникальными для 
каждой папки

# логика
_все что относится к структуре приложения_

- подумать о том, как сделать эффекты менее привязанными к основному коду
- попробовать нахрен переписать ресурсы - не как отдельный класс, а как 
учетную книгу в Cell, в которой хранятся записи тип - владелец - количество. или 
по крайней мере создавать новый ресурс для каждого владельца. ЗА: один источник правды,
не нужно следить чтобы сумма по собственникам равнялась общему количеству ресурса. ПРОТИВ:
- если resources является частью cell, то и capacity должна тоже; вообще, должен быть один 
механизм для того и другого, сейчас разброд и шатание какое-то. по-хорошему, наверное 
сколько ресурсов стартово в каждом биоме должно храниться отдельной константой где-то, а не 
в biome. отдельная система инструкций для создания клеток - столько то ресурсов, столько то
популяций. м/б объединить это с populate instructions в populate_history
- непоследовательные механизмы для создания новых world, history, grid и cell
- rules. проблема. по большому счету все, что есть в yaml-файлах - это вещи, которые не должны 
изменяться по ходу симуляции. пока что не будем создавать rules как абстрактные прототипы,
и все, даже неизменяемые, параметры будем держать тупо в сущностях. rules оставим в отдельной 
ветке rules (если вдруг захотим к ним вернуться)
- надо подумать, где у нас правильнее держать эффекты, и должно ли быть столько разных наследников agents


# модели
_что мы, собственно, моделируем. то, что лежит в файлах yaml и effects_

- смена биомов в клетке. сюжет: нижнее течение хуанхэ было всю дорогу 
болотами, и только уже в 1 тыс до р х люди превратили ее в равнины; до
этого жили на полуострове шаньдун, жили в среднем течении хуанхэ, а посередине 
были болота
- колебания температуры. сейчас идут просто по синусоиде; надо к этому добавить
случайную составляющую

- какая у нас проблема с рынком? на рынке обменивается излишек на - все остальное; 
когда только только появляются ремесла, они будут "собирать" оч много излишка; 
значит, нужен более умный механизм превращения в ремесленников; делаем переменную 
draw (или attraction), которая может зависеть от разных вещей, одна из них - прибыльность 
ремесла; и этот draw определяет сколько людей становятся этим сообществом. кроме того, 
нужна переменная barrier - барьер для соц. лифтов, которая будет отниматься от draw 
(или на нее делить draw). дальше в этот механизм встраиваем миграции - для каждой популяции
каждый ход будет список возможных других популяций, к которым её "притягивает" - как в своей
клетке, так и в соседних; правда, для моделей наверное удобнее хранить список популяций, ИЗ
которых эту популяцию можно пополнить

## бронзовый век

потребуется:
- механизм миграций
- дальняя торговля
- государства; возникают при достаточной производительности хозяйства и опр. 
численности населения. 

# БАГИ

- если запустить симуляцию surplus_and_craft и после первой экспансии начать прокручивать 
назад, только что созданные популяции никак не меняются
